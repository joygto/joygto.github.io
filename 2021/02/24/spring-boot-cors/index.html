<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/joygto.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/joygto.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Spring boot 在跨域访问方面的支持主要有如下几种方式，其中一些是有坑的：1. 实现CorsConfigurationSource接口（推荐）实现CorsConfigurationSource接口的类: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515">
<meta property="og:type" content="article">
<meta property="og:title" content="spring-boot-cors">
<meta property="og:url" content="http://example.com/2021/02/24/spring-boot-cors/index.html">
<meta property="og:site_name" content="三米阳光">
<meta property="og:description" content="Spring boot 在跨域访问方面的支持主要有如下几种方式，其中一些是有坑的：1. 实现CorsConfigurationSource接口（推荐）实现CorsConfigurationSource接口的类: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-24T13:02:21.000Z">
<meta property="article:modified_time" content="2021-02-24T13:02:40.933Z">
<meta property="article:author" content="Samy">
<meta property="article:tag" content="spring">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2021/02/24/spring-boot-cors/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>spring-boot-cors | 三米阳光</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a target="_blank" rel="noopener" href="https://github.com/joygto" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">三米阳光</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">开发手札和经验分享</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="categories fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/24/spring-boot-cors/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/joygto.jpg">
      <meta itemprop="name" content="Samy">
      <meta itemprop="description" content="心如花木 向阳而生">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="三米阳光">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          spring-boot-cors
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-24 21:02:21 / 修改时间：21:02:40" itemprop="dateCreated datePublished" datetime="2021-02-24T21:02:21+08:00">2021-02-24</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h4 id="Spring-boot-在跨域访问方面的支持主要有如下几种方式，其中一些是有坑的："><a href="#Spring-boot-在跨域访问方面的支持主要有如下几种方式，其中一些是有坑的：" class="headerlink" title="Spring boot 在跨域访问方面的支持主要有如下几种方式，其中一些是有坑的："></a>Spring boot 在跨域访问方面的支持主要有如下几种方式，其中一些是有坑的：</h4><h3 id="1-实现CorsConfigurationSource接口（推荐）"><a href="#1-实现CorsConfigurationSource接口（推荐）" class="headerlink" title="1. 实现CorsConfigurationSource接口（推荐）"></a>1. 实现CorsConfigurationSource接口（推荐）</h3><p>实现CorsConfigurationSource接口的类:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">@Slf4j</span><br><span class="line">@Component</span><br><span class="line">public class GlobalCorsConfigurationSource implements CorsConfigurationSource &#123;</span><br><span class="line"></span><br><span class="line">    protected static final String ORIGIN &#x3D; &quot;Origin&quot;;</span><br><span class="line">    protected static final Long MAX_AGE &#x3D; 1800L;</span><br><span class="line">    protected static final Boolean ALLOW_CREDENTIALS &#x3D; true;</span><br><span class="line">    protected static final List&lt;String&gt; ALLOW_HEADERS &#x3D; ImmutableList.of(&quot;*&quot;);</span><br><span class="line">    protected static final List&lt;String&gt; ALLOW_HTTP_METHODS &#x3D; ImmutableList.of(&quot;*&quot;);</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AccessControlProperties accessControlProperties;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public CorsConfiguration getCorsConfiguration(HttpServletRequest request) &#123;</span><br><span class="line">        CorsConfiguration corsConfiguration &#x3D; new CorsConfiguration();</span><br><span class="line"></span><br><span class="line">        final String origin &#x3D; request.getHeader(ORIGIN);</span><br><span class="line">        if (!StringUtils.isBlank(origin) &amp;&amp; isOriginAllowed(origin)) &#123;</span><br><span class="line">            corsConfiguration.setMaxAge(MAX_AGE);</span><br><span class="line">            corsConfiguration.setAllowCredentials(ALLOW_CREDENTIALS);</span><br><span class="line">            corsConfiguration.setAllowedOrigins(Arrays.asList(origin));</span><br><span class="line">            corsConfiguration.setAllowedHeaders(ALLOW_HEADERS);</span><br><span class="line">            corsConfiguration.setAllowedMethods(ALLOW_HTTP_METHODS);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return corsConfiguration;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isOriginAllowed(final String origin) &#123;</span><br><span class="line">        return isWildcardOrigin() || isOriginMatched(origin);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isWildcardOrigin() &#123;</span><br><span class="line">        List&lt;String&gt; allowOrigins &#x3D; accessControlProperties.getAllowedOrigins();</span><br><span class="line">        return CollectionUtils.isNotEmpty(allowOrigins)</span><br><span class="line">                &amp;&amp; allowOrigins.size() &#x3D;&#x3D; 1</span><br><span class="line">                &amp;&amp; StringUtils.equals(allowOrigins.get(0), &quot;*&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isOriginMatched(String origin) &#123;</span><br><span class="line">        List&lt;String&gt; allowedOrigins &#x3D; accessControlProperties.getAllowedOrigins();</span><br><span class="line"></span><br><span class="line">        if (CollectionUtils.isEmpty(allowedOrigins)) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (String allowedOrigin : allowedOrigins) &#123;</span><br><span class="line">            if (!StringUtils.isEmpty(allowedOrigin)) &#123;</span><br><span class="line">                String allowedOriginTrimStr &#x3D; allowedOrigin.trim();</span><br><span class="line">                if (allowedOriginTrimStr.startsWith(&quot;^&quot;) &amp;&amp; allowedOriginTrimStr.endsWith(&quot;$&quot;)) &#123;</span><br><span class="line">                    Matcher m &#x3D; Pattern.compile(allowedOriginTrimStr).matcher(origin);</span><br><span class="line">                    if (m.find()) &#123;</span><br><span class="line">                        return true;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    if (allowedOriginTrimStr.equals(origin)) &#123;</span><br><span class="line">                        return true;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过WebSecurityConfigurerAdaptor注册：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@EnableWebSecurity</span><br><span class="line">public class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line">        @Override</span><br><span class="line">        protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line">            http</span><br><span class="line">            .cors()</span><br><span class="line">            .configurationSource(globalCorsConfigurationSource)</span><br><span class="line">            .and()</span><br><span class="line">            .csrf()</span><br><span class="line">            .disable()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-通过WebMvcConfigurationSupport注册（推荐）"><a href="#2-通过WebMvcConfigurationSupport注册（推荐）" class="headerlink" title="2. 通过WebMvcConfigurationSupport注册（推荐）"></a>2. 通过WebMvcConfigurationSupport注册（推荐）</h3><p>虽然spring security很普及，但如果确实项目中不需要还可以通过WebMvcConfigurationSupport来添加跨域支持:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">@Slf4j</span><br><span class="line">@Configuration</span><br><span class="line">public class WebMvcConfig extends WebMvcConfigurationSupport &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private Environment env;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AccessControl accessControl;</span><br><span class="line"></span><br><span class="line">    @PostConstruct</span><br><span class="line">    public void init() &#123;</span><br><span class="line">        log.debug(&quot;Looking for Spring active profiles...&quot;);</span><br><span class="line">        if (env.getActiveProfiles().length &#x3D;&#x3D; 0) &#123;</span><br><span class="line">            log.info(&quot;No Spring profile configured, running with default configuration.&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            log.info(&quot;Detected Spring profiles: &#123;&#125;&quot;, Arrays.asList(env.getActiveProfiles()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void addResourceHandlers(ResourceHandlerRegistry registry) &#123;</span><br><span class="line">        registry.addResourceHandler(&quot;swagger-ui.html&quot;)</span><br><span class="line">            .addResourceLocations(&quot;classpath:&#x2F;META-INF&#x2F;resources&#x2F;&quot;);</span><br><span class="line">        registry.addResourceHandler(&quot;&#x2F;webjars&#x2F;**&quot;)</span><br><span class="line">            .addResourceLocations(&quot;classpath:&#x2F;META-INF&#x2F;resources&#x2F;webjars&#x2F;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected RequestMappingHandlerMapping createRequestMappingHandlerMapping() &#123;</span><br><span class="line">        return new ApiVersionRequestMappingHandlerMapping();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">        registry.addMapping(&quot;&#x2F;**&quot;)</span><br><span class="line">            .allowedOrigins(accessControl.getAllowOrigin().toArray(new String[accessControl.getAllowOrigin().size()]))</span><br><span class="line">            .allowedMethods(&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;)</span><br><span class="line">            .allowCredentials(true)</span><br><span class="line">            .maxAge(1800);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-随处可见的拦截器版（不推荐）"><a href="#3-随处可见的拦截器版（不推荐）" class="headerlink" title="3. 随处可见的拦截器版（不推荐）"></a>3. 随处可见的拦截器版（不推荐）</h3><p>原理是通过拦截器拦截请求，在reponse返回到客户端之前加入相应的Header。早在servlet时代类似的功能只能通过Filter实现，所以这个版本“随处可见”。但自从spring web 3.0.2版本后加入了ResponseEntity这个对象后，若控制器返回的是ResponseEntity对象，则会发现Header无法写入，原因在<a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#mvc">spring doc 1.1.6. Interception</a>:</p>
<blockquote>
<p>Note that the postHandle method of HandlerInterceptor is not always ideally suited for use with @ResponseBody and ResponseEntity methods. In such cases an HttpMessageConverter writes to and commits the response before postHandle is called which makes it impossible to change the response, for example to add a header. Instead an application can implement ResponseBodyAdvice and either declare it as an @ControllerAdvice bean or configure it directly on RequestMappingHandlerAdapter.<br>类似的网上2个相关的链接</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/48823794/spring-interceptor-doesnt-add-header-to-restcontroller-services">stack overflow</a></li>
<li>[Hugo搭的个人博客] (<a target="_blank" rel="noopener" href="https://mtyurt.net/post/spring-modify-response-headers-after-processing.html">https://mtyurt.net/post/spring-modify-response-headers-after-processing.html</a>)</li>
</ul>
<p>虽然不推荐，但倘若系统约定直接返回对象而非ResponseEntity，非用不可也不是不行，所以还是蛮贴下代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class CorsInterceptor extends HandlerInterceptorAdapter &#123;</span><br><span class="line"></span><br><span class="line">    private static final String ORIGIN &#x3D; &quot;Origin&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_ORIGIN &#x3D; &quot;Access-Control-Allow-Origin&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_METHODS &#x3D; &quot;Access-Control-Allow-Methods&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_HEADERS &#x3D; &quot;Access-Control-Allow-Headers&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_MAX_AGE &#x3D; &quot;Access-Control-Max-Age&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_REQUEST_HEADERS &#x3D; &quot;Access-Control-Request-Headers&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_CREDENTIALS &#x3D; &quot;Access-Control-Allow-Credentials&quot;;</span><br><span class="line">    private static final String ALLOW_HTTP_METHODS &#x3D; &quot;GET, POST, DELETE, PUT&quot;;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AccessControl accessControl;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void postHandle(HttpServletRequest request,</span><br><span class="line">                           HttpServletResponse response,</span><br><span class="line">                           Object handler,</span><br><span class="line">                           ModelAndView modelAndView) throws Exception &#123;</span><br><span class="line">        final String origin &#x3D; request.getHeader(ORIGIN);</span><br><span class="line">        if (StringUtils.isBlank(origin) || !validateOrigin(origin)) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        addCORSHeader(request, response, ACCESS_CONTROL_ALLOW_ORIGIN, origin);</span><br><span class="line">        addCORSHeader(request, response, ACCESS_CONTROL_ALLOW_CREDENTIALS, &quot;true&quot;);</span><br><span class="line">        if (needAddPreflightHeaders(request)) &#123;</span><br><span class="line">            addCORSHeader(request, response, ACCESS_CONTROL_ALLOW_METHODS, ALLOW_HTTP_METHODS);</span><br><span class="line">            String requestHeaders &#x3D; request.getHeader(ACCESS_CONTROL_REQUEST_HEADERS);</span><br><span class="line">            if (StringUtils.isNotBlank(requestHeaders)) &#123;</span><br><span class="line">                addCORSHeader(request, response, ACCESS_CONTROL_ALLOW_HEADERS, requestHeaders);</span><br><span class="line">            &#125;</span><br><span class="line">            addCORSHeader(request, response, ACCESS_CONTROL_MAX_AGE, &quot;1800&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean validateOrigin(final String origin) &#123;</span><br><span class="line">        return isWildcardOrigin() || isOriginAllowed(origin);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isWildcardOrigin() &#123;</span><br><span class="line">        List&lt;String&gt; allowOrigins &#x3D; accessControl.getAllowOrigin();</span><br><span class="line">        return CollectionUtils.isNotEmpty(allowOrigins)</span><br><span class="line">            &amp;&amp; allowOrigins.size() &#x3D;&#x3D; 1</span><br><span class="line">            &amp;&amp; StringUtils.equals(allowOrigins.get(0), &quot;*&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isOriginAllowed(final String origin) &#123;</span><br><span class="line">        List&lt;String&gt; allowOrigins &#x3D; accessControl.getAllowOrigin();</span><br><span class="line">        if (CollectionUtils.isEmpty(allowOrigins)) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        for (String allowOrigin : allowOrigins) &#123;</span><br><span class="line">            if (origin.contains(allowOrigin)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void addCORSHeader(HttpServletRequest request, HttpServletResponse response, String headerName, String origin) &#123;</span><br><span class="line">        if (StringUtils.isBlank(request.getHeader(headerName))) &#123;</span><br><span class="line">            response.addHeader(headerName, origin);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean needAddPreflightHeaders(HttpServletRequest request) &#123;</span><br><span class="line">        return StringUtils.equals(request.getMethod(), HttpMethod.OPTIONS.name());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-filter的实现（不推荐）"><a href="#4-filter的实现（不推荐）" class="headerlink" title="4. filter的实现（不推荐）"></a>4. filter的实现（不推荐）</h3><p>该版本就很有servlet时代的感觉了，虽然可以解决ResponseEntity使用场景下为Response增加Header的问题，但其实它还存在另一个问题：无法定制HttpStatus.该方法在ResponseEntity场景下返回的HttpStatus都是200，在如今Restful大行其道的今天显然依旧不可取。当然“万事情不抵我愿意”，如果决策者觉得状态码啥的都是浮云也是无话可说，所以照旧蛮贴上代码（临时找不到filter版本，抄了一下上面博主的）:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class DummyFilter extends OncePerRequestFilter &#123;</span><br><span class="line">    @Override</span><br><span class="line">    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException &#123;</span><br><span class="line">        HttpServletResponseWrapper wrapper &#x3D; new HttpServletResponseWrapper(response) &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void setStatus(int sc) &#123;</span><br><span class="line">                super.setStatus(sc);</span><br><span class="line">                handleStatus(sc);</span><br><span class="line">            &#125;</span><br><span class="line">            @Override</span><br><span class="line">            @SuppressWarnings(&quot;deprecation&quot;)</span><br><span class="line">            public void setStatus(int sc, String sm) &#123;</span><br><span class="line">                super.setStatus(sc, sm);</span><br><span class="line">                handleStatus(sc);</span><br><span class="line">            &#125;</span><br><span class="line">            @Override</span><br><span class="line">            public void sendError(int sc, String msg) throws IOException &#123;</span><br><span class="line">                super.sendError(sc, msg);</span><br><span class="line">                handleStatus(sc);</span><br><span class="line">            &#125;</span><br><span class="line">            @Override</span><br><span class="line">            public void sendError(int sc) throws IOException &#123;</span><br><span class="line">                super.sendError(sc);</span><br><span class="line">                handleStatus(sc);</span><br><span class="line">            &#125;</span><br><span class="line">            private void handleStatus(int code) &#123;</span><br><span class="line">                if(code &#x3D;&#x3D; 404)</span><br><span class="line">                    addHeader(&quot;dummy-header, &quot;dummy-value&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        filterChain.doFilter(request, wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-这次是第5版了，AOP版本，虽然显得逼格略高但没啥用，依-然-不-推-荐"><a href="#5-这次是第5版了，AOP版本，虽然显得逼格略高但没啥用，依-然-不-推-荐" class="headerlink" title="5. 这次是第5版了，AOP版本，虽然显得逼格略高但没啥用，依!然!不!推!荐!"></a>5. 这次是第5版了，AOP版本，虽然显得逼格略高但没啥用，依!然!不!推!荐!</h3><p>不推荐的原因，是因为实际测试过程中发现依旧403。猜测可能是因为当时系统中已经引入了spring security, 有默认的cors设置导致。当然如果项目中没有引入spring security应该是可行，但也会为未来引入spring security埋坑。照例还是贴上代码，没准还是有倔强的人儿呐喊：我就是要用这种方式装逼，系统我说了算将来就是不引入spring security.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">@ControllerAdvice</span><br><span class="line">public class CorsResponseAdvice implements ResponseBodyAdvice&lt;Object&gt; &#123;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_ORIGIN &#x3D; &quot;Access-Control-Allow-Origin&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_METHODS &#x3D; &quot;Access-Control-Allow-Methods&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_HEADERS &#x3D; &quot;Access-Control-Allow-Headers&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_MAX_AGE &#x3D; &quot;Access-Control-Max-Age&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_REQUEST_HEADERS &#x3D; &quot;Access-Control-Request-Headers&quot;;</span><br><span class="line">    private static final String ACCESS_CONTROL_ALLOW_CREDENTIALS &#x3D; &quot;Access-Control-Allow-Credentials&quot;;</span><br><span class="line">    private static final String ALLOW_HTTP_METHODS &#x3D; &quot;GET, POST, DELETE, PUT&quot;;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AccessControl accessControl;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean supports(MethodParameter methodParameter, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object beforeBodyWrite(Object body, MethodParameter methodParameter, MediaType mediaType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass, ServerHttpRequest serverHttpRequest, ServerHttpResponse serverHttpResponse) &#123;</span><br><span class="line">        final String origin &#x3D; serverHttpRequest.getHeaders().getOrigin();</span><br><span class="line">        if (StringUtils.isBlank(origin) || !validateOrigin(origin)) &#123;</span><br><span class="line">            return body;</span><br><span class="line">        &#125;</span><br><span class="line">        addCORSHeader(serverHttpRequest, serverHttpResponse, ACCESS_CONTROL_ALLOW_ORIGIN, origin);</span><br><span class="line">        addCORSHeader(serverHttpRequest, serverHttpResponse, ACCESS_CONTROL_ALLOW_CREDENTIALS, &quot;true&quot;);</span><br><span class="line">        if (needAddPreflightHeaders(serverHttpRequest)) &#123;</span><br><span class="line">            addCORSHeader(serverHttpRequest, serverHttpResponse, ACCESS_CONTROL_ALLOW_METHODS, ALLOW_HTTP_METHODS);</span><br><span class="line">            String requestHeaders &#x3D; serverHttpRequest.getHeaders().getFirst(ACCESS_CONTROL_REQUEST_HEADERS);</span><br><span class="line">            if (StringUtils.isNotBlank(requestHeaders)) &#123;</span><br><span class="line">                addCORSHeader(serverHttpRequest, serverHttpResponse, ACCESS_CONTROL_ALLOW_HEADERS, requestHeaders);</span><br><span class="line">            &#125;</span><br><span class="line">            addCORSHeader(serverHttpRequest, serverHttpResponse, ACCESS_CONTROL_MAX_AGE, &quot;1800&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        return body;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void addCORSHeader(ServerHttpRequest request, ServerHttpResponse response, String headerName, String origin) &#123;</span><br><span class="line">        if (StringUtils.isBlank(request.getHeaders().getFirst(headerName))) &#123;</span><br><span class="line">            response.getHeaders().add(headerName, origin);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean needAddPreflightHeaders(ServerHttpRequest request) &#123;</span><br><span class="line">        return StringUtils.equals(request.getMethodValue(), HttpMethod.OPTIONS.name());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean validateOrigin(final String origin) &#123;</span><br><span class="line">        return isWildcardOrigin() || isOriginAllowed(origin);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isWildcardOrigin() &#123;</span><br><span class="line">        List&lt;String&gt; allowOrigins &#x3D; accessControl.getAllowOrigin();</span><br><span class="line">        return CollectionUtils.isNotEmpty(allowOrigins)</span><br><span class="line">            &amp;&amp; allowOrigins.size() &#x3D;&#x3D; 1</span><br><span class="line">            &amp;&amp; StringUtils.equals(allowOrigins.get(0), &quot;*&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private boolean isOriginAllowed(final String origin) &#123;</span><br><span class="line">        List&lt;String&gt; allowOrigins &#x3D; accessControl.getAllowOrigin();</span><br><span class="line">        if (CollectionUtils.isEmpty(allowOrigins)) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        for (String allowOrigin : allowOrigins) &#123;</span><br><span class="line">            if (origin.contains(allowOrigin)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/spring/" rel="tag"># spring</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/02/24/spring-boot-auth/" rel="prev" title="spring-boot-auth">
      <i class="fa fa-chevron-left"></i> spring-boot-auth
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/02/24/design-first-vs-code-first/" rel="next" title="设计先行 vs 代码先行">
      设计先行 vs 代码先行 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Spring-boot-%E5%9C%A8%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE%E6%96%B9%E9%9D%A2%E7%9A%84%E6%94%AF%E6%8C%81%E4%B8%BB%E8%A6%81%E6%9C%89%E5%A6%82%E4%B8%8B%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%85%B6%E4%B8%AD%E4%B8%80%E4%BA%9B%E6%98%AF%E6%9C%89%E5%9D%91%E7%9A%84%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">Spring boot 在跨域访问方面的支持主要有如下几种方式，其中一些是有坑的：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%9E%E7%8E%B0CorsConfigurationSource%E6%8E%A5%E5%8F%A3%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number"></span> <span class="nav-text">1. 实现CorsConfigurationSource接口（推荐）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%80%9A%E8%BF%87WebMvcConfigurationSupport%E6%B3%A8%E5%86%8C%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number"></span> <span class="nav-text">2. 通过WebMvcConfigurationSupport注册（推荐）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%9A%8F%E5%A4%84%E5%8F%AF%E8%A7%81%E7%9A%84%E6%8B%A6%E6%88%AA%E5%99%A8%E7%89%88%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number"></span> <span class="nav-text">3. 随处可见的拦截器版（不推荐）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-filter%E7%9A%84%E5%AE%9E%E7%8E%B0%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number"></span> <span class="nav-text">4. filter的实现（不推荐）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E8%BF%99%E6%AC%A1%E6%98%AF%E7%AC%AC5%E7%89%88%E4%BA%86%EF%BC%8CAOP%E7%89%88%E6%9C%AC%EF%BC%8C%E8%99%BD%E7%84%B6%E6%98%BE%E5%BE%97%E9%80%BC%E6%A0%BC%E7%95%A5%E9%AB%98%E4%BD%86%E6%B2%A1%E5%95%A5%E7%94%A8%EF%BC%8C%E4%BE%9D-%E7%84%B6-%E4%B8%8D-%E6%8E%A8-%E8%8D%90"><span class="nav-number"></span> <span class="nav-text">5. 这次是第5版了，AOP版本，虽然显得逼格略高但没啥用，依!然!不!推!荐!</span></a></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Samy"
      src="/images/joygto.jpg">
  <p class="site-author-name" itemprop="name">Samy</p>
  <div class="site-description" itemprop="description">心如花木 向阳而生</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Samy</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
